<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://download.playfab.com; style-src 'self' 'unsafe-inline' https://unpkg.com; img-src 'self' data:; connect-src 'self' https://*.playfabapi.com https://playfabapi.com;">

    <!-- Link to Pico.css CDN -->
    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
    <link rel="stylesheet" href="common.css"> <!-- Shared styles -->

    <title>Create Team - FUCCL</title>
</head>

<body>
    <main class="container">
    <header>
      <h1>Create Your Team</h1>
    </header>

    <section>
      <form id="create-team" onsubmit="registerTeam(event)">
        <label for="teamName">
          Team Name:
          <small style="color: #666; display: block; margin-top: 0.25rem;">Maximum 30 characters. Letters, numbers, spaces, hyphens, and apostrophes only.</small>
        </label>
        <input type="text" id="teamName" required maxlength="30" placeholder="Enter your team name">

        <label for="managerName">
          Manager Name:
          <small style="color: #666; display: block; margin-top: 0.25rem;">Maximum 20 characters. Letters, spaces, hyphens, and apostrophes only.</small>
        </label>
        <input type="text" id="managerName" required maxlength="20" placeholder="Enter your manager name">

        <button type="submit">Create Team</button>
      </form>
    </section>

    <!-- Load the PlayFab SDK from the CDN -->
    <script type="text/javascript" src="https://download.playfab.com/PlayFabClientApi.js"></script>
    <!-- Link to your custom script -->
    <script src="common.js"></script>
    
    <script>
        // Real-time validation for team and manager names
        document.addEventListener('DOMContentLoaded', function() {
            const teamNameInput = document.getElementById('teamName');
            const managerNameInput = document.getElementById('managerName');
            
            // Add character counter for team name
            const teamCounter = document.createElement('small');
            teamCounter.style.cssText = 'color: #666; float: right; margin-top: -1.5rem;';
            teamNameInput.parentNode.appendChild(teamCounter);
            
            // Add character counter for manager name
            const managerCounter = document.createElement('small');
            managerCounter.style.cssText = 'color: #666; float: right; margin-top: -1.5rem;';
            managerNameInput.parentNode.appendChild(managerCounter);
            
            function updateCounters() {
                const teamLength = teamNameInput.value.length;
                const managerLength = managerNameInput.value.length;
                
                teamCounter.textContent = `${teamLength}/30`;
                managerCounter.textContent = `${managerLength}/20`;
                
                // Change color based on length
                teamCounter.style.color = teamLength > 30 ? '#d73a49' : teamLength > 25 ? '#f9c513' : '#666';
                managerCounter.style.color = managerLength > 20 ? '#d73a49' : managerLength > 15 ? '#f9c513' : '#666';
            }
            
            // Update counters on input
            teamNameInput.addEventListener('input', updateCounters);
            managerNameInput.addEventListener('input', updateCounters);
            
            // Initial update
            updateCounters();
            
            // Real-time validation feedback
            function validateInput(input, type) {
                const value = input.value;
                let isValid = true;
                let message = '';
                
                if (value.trim().length === 0) {
                    isValid = false;
                    message = `Please enter a ${type} name`;
                } else if (type === 'team' && value.length > 30) {
                    isValid = false;
                    message = 'Team name is too long (max 30 characters)';
                } else if (type === 'manager' && value.length > 20) {
                    isValid = false;
                    message = 'Manager name is too long (max 20 characters)';
                } else if (value.length < 2) {
                    isValid = false;
                    message = `${type} name must be at least 2 characters`;
                } else {
                    // Check for inappropriate content (simplified client-side check)
                    const blockedWords = ['fuck', 'shit', 'damn', 'bitch', 'bastard', 'asshole', 'cunt', 'nigger', 'slut', 'whore', 'kill', 'rape', 'sex', 'porn'];
                    const lowerValue = value.toLowerCase();
                    for (const word of blockedWords) {
                        if (lowerValue.includes(word)) {
                            isValid = false;
                            message = `${type} name contains inappropriate content`;
                            break;
                        }
                    }
                }
                
                // Update input styling
                if (isValid) {
                    input.style.borderColor = '#4CAF50';
                } else {
                    input.style.borderColor = '#d73a49';
                }
                
                return { isValid, message };
            }
            
            // Add validation on blur
            teamNameInput.addEventListener('blur', function() {
                const validation = validateInput(this, 'team');
                if (!validation.isValid) {
                    this.setCustomValidity(validation.message);
                } else {
                    this.setCustomValidity('');
                }
            });
            
            managerNameInput.addEventListener('blur', function() {
                const validation = validateInput(this, 'manager');
                if (!validation.isValid) {
                    this.setCustomValidity(validation.message);
                } else {
                    this.setCustomValidity('');
                }
            });
        });
    </script>

  </main>
</body>

</html>